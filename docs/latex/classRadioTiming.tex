\hypertarget{classRadioTiming}{}\doxysection{Radio\+Timing Class Reference}
\label{classRadioTiming}\index{RadioTiming@{RadioTiming}}


Different Lo\+Ra bandwidths, in K\+Hz.  




{\ttfamily \#include $<$radio\+\_\+timing.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classRadioTiming_a8889214bcfb05975e8ed121a59ffb06c}{compute\+Times}} (const uint32\+\_\+t bw, const uint8\+\_\+t sf, const uint8\+\_\+t cr, const uint32\+\_\+t n\+\_\+pre\+\_\+sym, uint8\+\_\+t n\+\_\+pld\+\_\+bytes)
\item 
void \mbox{\hyperlink{classRadioTiming_a5968dcc1c5dc7aa644e4fd4b3c44f373}{wait\+Full\+Slots}} (const size\+\_\+t num\+\_\+slots)
\item 
void \mbox{\hyperlink{classRadioTiming_aab7180a1d7b4eda3c0d56506ffc18b43}{wait\+Sym\+Offset}} (const uint8\+\_\+t symb\+\_\+frac, const float direction, const uint8\+\_\+t num\+\_\+inc)
\item 
void \mbox{\hyperlink{classRadioTiming_ab794bed8927778ed17a9cbbfe1cf4a5f}{wait\+Rx\+Remainder}} (const size\+\_\+t sym\+\_\+wait, const size\+\_\+t pre\+\_\+wait)
\item 
void \mbox{\hyperlink{classRadioTiming_a763af2aa098f7b311c149dbf062d40a2}{calc\+Wait\+Symbol}} (void)
\item 
void \mbox{\hyperlink{classRadioTiming_ab88cd62548731862e0a24c986bf095bf}{calc\+Wait\+Preamble}} (void)
\item 
void \mbox{\hyperlink{classRadioTiming_a8451969371826cd733288652f5323053}{wait\+Tx}} (void)
\item 
void \mbox{\hyperlink{classRadioTiming_a3f5c69b632a02ec4a43e27ba5e4efef4}{set\+Timer}} (shared\+\_\+ptr$<$ Timer $>$ my\+\_\+tmr\+\_\+sptr)
\item 
int32\+\_\+t \mbox{\hyperlink{classRadioTiming_a50d3daa48f987d742b025d37789ed735}{get\+Wait\+No\+Warn}} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classRadioTiming_aefbdd2b026a1a79309d6aeeefdaf40b8}\label{classRadioTiming_aefbdd2b026a1a79309d6aeeefdaf40b8}} 
float {\bfseries sym\+\_\+time\+\_\+s}
\item 
\mbox{\Hypertarget{classRadioTiming_ad19e65dbeeb639eb6ee649866e89e536}\label{classRadioTiming_ad19e65dbeeb639eb6ee649866e89e536}} 
float {\bfseries pre\+\_\+time\+\_\+s}
\item 
\mbox{\Hypertarget{classRadioTiming_ac36b1fb03c10f93b24d056874ac51a45}\label{classRadioTiming_ac36b1fb03c10f93b24d056874ac51a45}} 
float {\bfseries pld\+\_\+time\+\_\+s}
\item 
\mbox{\Hypertarget{classRadioTiming_a184adafe6bf2be6dfcf82ca2a0a5637e}\label{classRadioTiming_a184adafe6bf2be6dfcf82ca2a0a5637e}} 
float {\bfseries pkt\+\_\+time\+\_\+s}
\item 
\mbox{\Hypertarget{classRadioTiming_a81443aaabc3c0c3b78ed3043b17d5806}\label{classRadioTiming_a81443aaabc3c0c3b78ed3043b17d5806}} 
float {\bfseries sym\+\_\+frac\+\_\+s}
\item 
\mbox{\Hypertarget{classRadioTiming_ab5b6fbb40a3a6cbc106c8a11b1b0ad3c}\label{classRadioTiming_ab5b6fbb40a3a6cbc106c8a11b1b0ad3c}} 
uint32\+\_\+t {\bfseries sym\+\_\+time\+\_\+ms}
\item 
\mbox{\Hypertarget{classRadioTiming_a684ff61587b4e602d68e368828d5e0fd}\label{classRadioTiming_a684ff61587b4e602d68e368828d5e0fd}} 
uint32\+\_\+t {\bfseries pre\+\_\+time\+\_\+ms}
\item 
\mbox{\Hypertarget{classRadioTiming_a7844f4062af12e888c4518a077c5b71e}\label{classRadioTiming_a7844f4062af12e888c4518a077c5b71e}} 
uint32\+\_\+t {\bfseries pld\+\_\+time\+\_\+ms}
\item 
\mbox{\Hypertarget{classRadioTiming_a55dfaed2581c0a80e77a74bed7e4a8aa}\label{classRadioTiming_a55dfaed2581c0a80e77a74bed7e4a8aa}} 
uint32\+\_\+t {\bfseries pkt\+\_\+time\+\_\+ms}
\item 
\mbox{\Hypertarget{classRadioTiming_ae05d86854591a70740408ed065326693}\label{classRadioTiming_ae05d86854591a70740408ed065326693}} 
uint32\+\_\+t {\bfseries sym\+\_\+frac\+\_\+ms}
\item 
\mbox{\Hypertarget{classRadioTiming_aa03e719ed43539a05e1c7cef92fc8f22}\label{classRadioTiming_aa03e719ed43539a05e1c7cef92fc8f22}} 
uint32\+\_\+t {\bfseries sym\+\_\+time\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_a08dd97045580ced34fc273ea4a70b5a5}\label{classRadioTiming_a08dd97045580ced34fc273ea4a70b5a5}} 
uint32\+\_\+t {\bfseries pre\+\_\+time\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_ab5e0df9c2b1eda8fdc63c871c005ea92}\label{classRadioTiming_ab5e0df9c2b1eda8fdc63c871c005ea92}} 
uint32\+\_\+t {\bfseries pld\+\_\+time\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_a754e188f6b7f7c35758a2772921b2772}\label{classRadioTiming_a754e188f6b7f7c35758a2772921b2772}} 
uint32\+\_\+t {\bfseries pkt\+\_\+time\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_adb8ac7bfc6a47573783f81e2e73f6f19}\label{classRadioTiming_adb8ac7bfc6a47573783f81e2e73f6f19}} 
uint32\+\_\+t {\bfseries sym\+\_\+frac\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_aaf4435d9eea1188f33cc4ee721d50aca}\label{classRadioTiming_aaf4435d9eea1188f33cc4ee721d50aca}} 
uint32\+\_\+t {\bfseries n\+\_\+sym\+\_\+pre}
\item 
\mbox{\Hypertarget{classRadioTiming_a45c73aab6fb2f5c99f7976719f645abf}\label{classRadioTiming_a45c73aab6fb2f5c99f7976719f645abf}} 
uint32\+\_\+t {\bfseries n\+\_\+sym\+\_\+pld}
\item 
\mbox{\Hypertarget{classRadioTiming_af93a55972434e013e09fadcd311381ab}\label{classRadioTiming_af93a55972434e013e09fadcd311381ab}} 
uint32\+\_\+t {\bfseries n\+\_\+sym\+\_\+pkt}
\item 
\mbox{\Hypertarget{classRadioTiming_a67b79a8285adbcaf5dbc816dbf744f2b}\label{classRadioTiming_a67b79a8285adbcaf5dbc816dbf744f2b}} 
uint32\+\_\+t {\bfseries sym\+\_\+wait\+\_\+factor}
\item 
\mbox{\Hypertarget{classRadioTiming_aba1eba0435a7dc3d3103e40a30086b9e}\label{classRadioTiming_aba1eba0435a7dc3d3103e40a30086b9e}} 
uint32\+\_\+t {\bfseries sym\+\_\+wait\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_a63d388c95d8eff525d12c199d6bd59fe}\label{classRadioTiming_a63d388c95d8eff525d12c199d6bd59fe}} 
uint32\+\_\+t {\bfseries pre\+\_\+wait\+\_\+factor}
\item 
\mbox{\Hypertarget{classRadioTiming_ae1c4611a8d342a27c11d7b6f7adcb6a9}\label{classRadioTiming_ae1c4611a8d342a27c11d7b6f7adcb6a9}} 
uint32\+\_\+t {\bfseries pre\+\_\+wait\+\_\+us}
\item 
\mbox{\Hypertarget{classRadioTiming_a4096268cfb4aa575c0eed20ebad0e788}\label{classRadioTiming_a4096268cfb4aa575c0eed20ebad0e788}} 
shared\+\_\+ptr$<$ Timer $>$ {\bfseries tmr\+\_\+sptr}
\item 
\mbox{\Hypertarget{classRadioTiming_ac1c9c1a3f43df35fede3320b17ecfcef}\label{classRadioTiming_ac1c9c1a3f43df35fede3320b17ecfcef}} 
int32\+\_\+t {\bfseries wait\+\_\+duration\+\_\+us}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Different Lo\+Ra bandwidths, in K\+Hz. 

A synchronized flooded mesh has all sort of timing-\/related things it needs to handle. This class handles all of these different timing things. Specifically, it handles\+:
\begin{DoxyItemize}
\item Calculating Lo\+Ra timing values, such as symbol duration, preamble duration, payload duration, etc.
\item Starting and stopping the fine-\/grained (millisecond or less) timer(s) necessary to make sure transmissions are properly synchronized.
\item Waiting the precise amount of time before e.\+g. retransmitting. 
\end{DoxyItemize}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classRadioTiming_ab88cd62548731862e0a24c986bf095bf}\label{classRadioTiming_ab88cd62548731862e0a24c986bf095bf}} 
\index{RadioTiming@{RadioTiming}!calcWaitPreamble@{calcWaitPreamble}}
\index{calcWaitPreamble@{calcWaitPreamble}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{calcWaitPreamble()}{calcWaitPreamble()}}
{\footnotesize\ttfamily void Radio\+Timing\+::calc\+Wait\+Preamble (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Calculate the random preamble-\/length wait period. Chooses between \mbox{[}0,3\mbox{]} different preamble offsets. \mbox{\Hypertarget{classRadioTiming_a763af2aa098f7b311c149dbf062d40a2}\label{classRadioTiming_a763af2aa098f7b311c149dbf062d40a2}} 
\index{RadioTiming@{RadioTiming}!calcWaitSymbol@{calcWaitSymbol}}
\index{calcWaitSymbol@{calcWaitSymbol}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{calcWaitSymbol()}{calcWaitSymbol()}}
{\footnotesize\ttfamily void Radio\+Timing\+::calc\+Wait\+Symbol (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Calculate a random intra-\/symbol wait duration. Chooses between \mbox{[}0,7\mbox{]} eights of the symbol duration. Stores the result internally within the object. \mbox{\Hypertarget{classRadioTiming_a8889214bcfb05975e8ed121a59ffb06c}\label{classRadioTiming_a8889214bcfb05975e8ed121a59ffb06c}} 
\index{RadioTiming@{RadioTiming}!computeTimes@{computeTimes}}
\index{computeTimes@{computeTimes}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{computeTimes()}{computeTimes()}}
{\footnotesize\ttfamily void Radio\+Timing\+::compute\+Times (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{bw,  }\item[{const uint8\+\_\+t}]{sf,  }\item[{const uint8\+\_\+t}]{cr,  }\item[{const uint32\+\_\+t}]{n\+\_\+pre\+\_\+sym,  }\item[{uint8\+\_\+t}]{n\+\_\+pld\+\_\+bytes }\end{DoxyParamCaption})}

Given the various Lo\+Ra parameters, pre-\/compute all of the different timing parameters. 
\begin{DoxyParams}{Parameters}
{\em bw} & Lo\+Ra bandwidth. \\
\hline
{\em sf} & Lo\+Ra spreading factor. \\
\hline
{\em cr} & Lo\+Ra coding rate. \\
\hline
{\em n\+\_\+pre\+\_\+sym} & Number of preamble symbols. \\
\hline
{\em n\+\_\+pld\+\_\+bytes} & Number of payload bytes. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classRadioTiming_a50d3daa48f987d742b025d37789ed735}\label{classRadioTiming_a50d3daa48f987d742b025d37789ed735}} 
\index{RadioTiming@{RadioTiming}!getWaitNoWarn@{getWaitNoWarn}}
\index{getWaitNoWarn@{getWaitNoWarn}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{getWaitNoWarn()}{getWaitNoWarn()}}
{\footnotesize\ttfamily int32\+\_\+t Radio\+Timing\+::get\+Wait\+No\+Warn (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Returns the wait duration, in microseconds. This wait duration factors in remaining time as well as any sort of intra-\/symbol timing offset. \mbox{\Hypertarget{classRadioTiming_a3f5c69b632a02ec4a43e27ba5e4efef4}\label{classRadioTiming_a3f5c69b632a02ec4a43e27ba5e4efef4}} 
\index{RadioTiming@{RadioTiming}!setTimer@{setTimer}}
\index{setTimer@{setTimer}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{setTimer()}{setTimer()}}
{\footnotesize\ttfamily void Radio\+Timing\+::set\+Timer (\begin{DoxyParamCaption}\item[{shared\+\_\+ptr$<$ Timer $>$}]{my\+\_\+tmr\+\_\+sptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Starts the protocol timer. \mbox{\Hypertarget{classRadioTiming_a5968dcc1c5dc7aa644e4fd4b3c44f373}\label{classRadioTiming_a5968dcc1c5dc7aa644e4fd4b3c44f373}} 
\index{RadioTiming@{RadioTiming}!waitFullSlots@{waitFullSlots}}
\index{waitFullSlots@{waitFullSlots}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{waitFullSlots()}{waitFullSlots()}}
{\footnotesize\ttfamily void Radio\+Timing\+::wait\+Full\+Slots (\begin{DoxyParamCaption}\item[{const size\+\_\+t}]{num\+\_\+slots }\end{DoxyParamCaption})}

Wait for a number of transmit slots. Note that this function uses the timer\textquotesingle{}s start time as the basis for how long to wait. Since the timer is typically started right after a Lo\+Ra packet is received, this function allows us to prepare a packet for retransmission, wait the remainder of one timeslot, and then retransmit it. 
\begin{DoxyParams}{Parameters}
{\em num\+\_\+slots} & Number of slots to wait. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classRadioTiming_ab794bed8927778ed17a9cbbfe1cf4a5f}\label{classRadioTiming_ab794bed8927778ed17a9cbbfe1cf4a5f}} 
\index{RadioTiming@{RadioTiming}!waitRxRemainder@{waitRxRemainder}}
\index{waitRxRemainder@{waitRxRemainder}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{waitRxRemainder()}{waitRxRemainder()}}
{\footnotesize\ttfamily void Radio\+Timing\+::wait\+Rx\+Remainder (\begin{DoxyParamCaption}\item[{const size\+\_\+t}]{sym\+\_\+wait,  }\item[{const size\+\_\+t}]{pre\+\_\+wait }\end{DoxyParamCaption})}

Wait for the \char`\"{}remaining time\char`\"{} that includes various timing offsets used to implement Q\+Mesh\textquotesingle{}s collision resistance\+:
\begin{DoxyItemize}
\item Number of Preamble durations to wait
\item Intra-\/symbol delay fraction 
\begin{DoxyParams}{Parameters}
{\em sym\+\_\+wait} & How many eighths of a symbol to delay \\
\hline
{\em pre\+\_\+wait} & Number of preambles to wait \\
\hline
\end{DoxyParams}

\end{DoxyItemize}\mbox{\Hypertarget{classRadioTiming_aab7180a1d7b4eda3c0d56506ffc18b43}\label{classRadioTiming_aab7180a1d7b4eda3c0d56506ffc18b43}} 
\index{RadioTiming@{RadioTiming}!waitSymOffset@{waitSymOffset}}
\index{waitSymOffset@{waitSymOffset}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{waitSymOffset()}{waitSymOffset()}}
{\footnotesize\ttfamily void Radio\+Timing\+::wait\+Sym\+Offset (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t}]{symb\+\_\+frac,  }\item[{const float}]{direction,  }\item[{const uint8\+\_\+t}]{num\+\_\+inc }\end{DoxyParamCaption})}

Wait for a fraction of a symbol. 
\begin{DoxyParams}{Parameters}
{\em symb\+\_\+frac} & The fraction of the symbol, in eigths of half a symbol duration, to wait. @papram direction should be either 1.\+0f or -\/1.\+0f, used to set the direction \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classRadioTiming_a8451969371826cd733288652f5323053}\label{classRadioTiming_a8451969371826cd733288652f5323053}} 
\index{RadioTiming@{RadioTiming}!waitTx@{waitTx}}
\index{waitTx@{waitTx}!RadioTiming@{RadioTiming}}
\doxysubsubsection{\texorpdfstring{waitTx()}{waitTx()}}
{\footnotesize\ttfamily void Radio\+Timing\+::wait\+Tx (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Wait for the symbol and preamble offset durations. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
inc/protocol/radio\+\_\+timing.\+hpp\item 
src/protocol/radio\+\_\+timing.\+cpp\end{DoxyCompactItemize}
